generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model OrganizationTypes {
  type               String          @id
  organizationEntity Organizations[]

  @@map("organization_types")
}

model Organizations {
  id                     String             @id @default(uuid())
  name                   String             @unique
  description            String?
  organizationType       String             @map("organization_type")
  city                   String?
  country                String?
  street1                String?
  street2                String?
  email                  String?
  phoneNumber            String?            @map("phone_number")
  postalCode             String?            @map("postal_code")
  stateOrRegion          String?            @map("state_or_region")
  invitationEmailEntity  InvitationEmails[]
  organizationTypeEntity OrganizationTypes  @relation(fields: [organizationType], references: [type])
  users                  Users[]

  @@index([organizationType], map: "organizations_organization_type_fkey")
  @@map("organizations")
}

model Roles {
  role                  String             @id
  invitationEmailEntity InvitationEmails[]
  UserRole              UserRole[]

  @@map("roles")
}

model InvitationEmails {
  code               String        @id
  email              String
  role               String
  organizationId     String        @map("organization_id")
  organizationEntity Organizations @relation(fields: [organizationId], references: [id])
  rolesEntity        Roles         @relation(fields: [role], references: [role])

  @@index([organizationId], map: "invitation_emails_organization_id_fkey")
  @@index([role], map: "invitation_emails_role_fkey")
  @@map("invitation_emails")
}

model UserRole {
  role        String
  userId      String @map("user_id")
  rolesEntity Roles  @relation(fields: [role], references: [role])
  userEntity  Users  @relation(fields: [userId], references: [id])

  @@id([userId, role])
  @@index([role], map: "user_role_role_fkey")
  @@map("user_role")
}

model Users {
  id                     String                   @id @default(uuid())
  email                  String                   @unique
  firstName              String                   @map("first_name")
  lastName               String                   @map("last_name")
  organizationId         String                   @map("organization_id")
  passwordEntity         Passwords?
  UserElectricalLicenses UserElectricalLicenses[]
  UserPosition           UserPosition[]
  userRoleEntity         UserRole[]
  UserService            UserService[]
  UserStructuralLicenses UserStructuralLicenses[]
  organizationEntity     Organizations            @relation(fields: [organizationId], references: [id])

  @@index([organizationId], map: "users_organization_id_fkey")
  @@map("users")
}

model Passwords {
  userId   String @unique @map("user_id")
  password String
  user     Users  @relation(fields: [userId], references: [id])

  @@map("passwords")
}

model Departments {
  id          String      @id @default(uuid())
  name        String
  description String
  Positions   Positions[]

  @@map("departments")
}

model Positions {
  id               String            @id @default(uuid())
  name             String
  description      String
  departmentId     String            @map("department_id")
  PositionService  PositionService[]
  departmentEntity Departments       @relation(fields: [departmentId], references: [id])
  UserPosition     UserPosition[]

  @@index([departmentId], map: "positions_department_id_fkey")
  @@map("positions")
}

model Services {
  id              String            @id @default(uuid())
  name            String
  description     String
  PositionService PositionService[]
  UserService     UserService[]

  @@map("services")
}

model PositionService {
  positionId     String    @map("position_id")
  serviceId      String    @map("service_id")
  positionEntity Positions @relation(fields: [positionId], references: [id])
  serviceEntity  Services  @relation(fields: [serviceId], references: [id])

  @@id([positionId, serviceId])
  @@index([serviceId], map: "position_service_service_id_fkey")
  @@map("position_service")
}

model UserService {
  userId        String   @map("user_id")
  serviceId     String   @map("service_id")
  serviceEntity Services @relation(fields: [serviceId], references: [id])
  userEntity    Users    @relation(fields: [userId], references: [id])

  @@id([userId, serviceId])
  @@index([serviceId], map: "user_service_service_id_fkey")
  @@map("user_service")
}

model States {
  stateName              String                   @map("state_name")
  abbreviation           String                   @map("abbreviation")
  geoId                  String                   @map("geo_id") @db.VarChar(20)
  stateCode              String?                  @map("state_code") @db.VarChar(20)
  ansiCode               String?                  @map("ansi_code") @db.VarChar(20)
  stateLongName          String?                  @map("state_long_name")
  UserElectricalLicenses UserElectricalLicenses[]
  UserStructuralLicenses UserStructuralLicenses[]

  @@id([stateName, abbreviation])
  @@map("states")
}

model UserStructuralLicenses {
  userId             String    @map("user_id")
  issuingCountryName String    @map("issuing_country_name")
  abbreviation       String
  priority           Int?
  expiryDate         DateTime? @map("expiry_date")
  issuedDate         DateTime? @map("issue_date")
  stateEntity        States    @relation(fields: [issuingCountryName, abbreviation], references: [stateName, abbreviation])
  userEntity         Users     @relation(fields: [userId], references: [id])

  @@id([userId, issuingCountryName])
  @@index([issuingCountryName, abbreviation], map: "user_structural_licenses_issuing_country_name_abbreviation_fkey")
  @@map("user_structural_licenses")
}

model UserElectricalLicenses {
  userId             String    @map("user_id")
  issuingCountryName String    @map("issuing_country_name")
  abbreviation       String
  expiryDate         DateTime? @map("expiry_date")
  issuedDate         DateTime? @map("issue_date")
  priority           Int?
  stateEntity        States    @relation(fields: [issuingCountryName, abbreviation], references: [stateName, abbreviation])
  userEntity         Users     @relation(fields: [userId], references: [id])

  @@id([userId, issuingCountryName])
  @@index([issuingCountryName, abbreviation], map: "user_electrical_licenses_issuing_country_name_abbreviation_fkey")
  @@map("user_electrical_licenses")
}

model UserPosition {
  userId         String    @map("user_id")
  positionId     String    @map("position_id")
  positionEntity Positions @relation(fields: [positionId], references: [id])
  userEntity     Users     @relation(fields: [userId], references: [id])

  @@id([userId, positionId])
  @@index([positionId], map: "user_position_position_id_fkey")
  @@map("user_position")
}
