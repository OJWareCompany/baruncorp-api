generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model OrganizationTypes {
  type              String              @id
  organizationRoles OrganizationRoles[]
  organizations     Organizations[]

  @@map("organization_types")
}

model Organizations {
  id                     Int               @id @default(autoincrement())
  name                   String            @unique
  description            String
  organizationType       String            @map("organization_type")
  organizationTypeEntity OrganizationTypes @relation(fields: [organizationType], references: [type])

  @@index([organizationType], map: "organizations_organization_type_fkey")
  @@map("organizations")
}

model Roles {
  role              String              @id
  organizationRoles OrganizationRoles[]

  @@map("roles")
}

model OrganizationRoles {
  role                   String
  organizationType       String            @map("organization_type")
  organizationTypeEntity OrganizationTypes @relation(fields: [organizationType], references: [type])
  rolesEntity            Roles             @relation(fields: [role], references: [role])

  @@id([organizationType, role])
  @@index([role], map: "organization_roles_role_fkey")
  @@map("organization_roles")
}

model InvitationEmail {
  code             String @id
  organizationId   Int    @map("organization_id")
  role             String
  organizationType String @map("organization_type")
  email            String

  @@map("invitation_email")
}

model UserRole {
  role             String
  organizationType String @map("organization_type")
  userId           String @map("user_id")
  user             Users  @relation(fields: [userId], references: [id])

  @@id([userId, role, organizationType])
  @@map("user_role")
}

model Users {
  id             String     @id @default(uuid())
  email          String     @unique
  firstName      String     @map("first_name")
  lastName       String     @map("last_name")
  organizationId Int?
  passwordEntity Passwords?
  UserRole       UserRole[]

  @@map("users")
}

model Passwords {
  userId   String @unique @map("user_id")
  password String
  user     Users  @relation(fields: [userId], references: [id])

  @@id([userId, password])
  @@map("passwords")
}
